function highlightTerms(html) {
  const terms = JSON.parse(localStorage.getItem("terms") || "[]");
  if (terms.length === 0) return html;

  // Bouw regex
  const escaped = terms.map(t => t.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'));
  const regex = new RegExp(`\\b(${escaped.join("|")})\\b`, "gi");

  // HTML â†’ DOM
  const container = document.createElement("div");
  container.innerHTML = html;

  // Recursieve functie om tekstnodes te highlighten
  function walk(node) {
    if (node.nodeType === Node.TEXT_NODE) {
      const original = node.textContent;
      if (regex.test(original)) {
        const span = document.createElement("span");
        span.innerHTML = original.replace(regex, m => `<span class="hl">${m}</span>`);
        node.replaceWith(...span.childNodes);
      }
      return;
    }

    node.childNodes.forEach(walk);
  }

  walk(container);

  return container.innerHTML;
}
